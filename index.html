<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cozinha</title>
    <link rel="apple-touch-icon" href="img.Ã­cone.jpeg.jpg">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; padding: 20px; }
        h1 { color: #ffc107; text-align: center; border-bottom: 2px solid #ffc107; }
        #btn-ativar { background: #d32f2f; color: #fff; border: none; padding: 20px; border-radius: 10px; width: 100%; font-weight: bold; margin-bottom: 20px; }
        .pedido-card { background: #111; border: 2px solid #ffc107; border-radius: 12px; padding: 15px; margin-bottom: 15px; }
        .itens { font-size: 1.4rem; margin: 10px 0; background: #1a1a1a; padding: 10px; border-radius: 5px; }
        .btn-ok { background: #4caf50; color: #fff; border: none; padding: 15px; width: 100%; border-radius: 8px; font-weight: bold; }
    </style>
</head>
<body>
    <button id="btn-ativar" onclick="liberarSom()">ðŸ”´ ATIVAR SOM DO CHEF</button>
    <h1>PEDIDOS</h1>
    <div id="lista"></div>
    <audio id="som"><source src="somdopedido.mp3.mp3" type="audio/mpeg"></audio>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const config = {
        databaseURL: "https://cardapio-restaurante-df665-default-rtdb.firebaseio.com/",
    };

    const app = initializeApp(config);
    const db = getDatabase(app);
    const audio = document.getElementById('som');
    let somOk = false;
    let pronto = false;

    window.liberarSom = () => {
        audio.play().then(() => { audio.pause(); somOk = true; document.getElementById('btn-ativar').style.display='none'; });
    };

    onValue(ref(db, 'pedidos'), (snap) => {
        const dados = snap.val();
        if (dados && pronto && somOk) audio.play();
        const lista = document.getElementById('lista');
        lista.innerHTML = "";
        for (let id in dados) {
            const p = dados[id];
            lista.innerHTML += `<div class="pedido-card"><h3>${p.cliente}</h3><div class="itens">${p.itens}</div><button class="btn-ok" onclick="concluir('${id}')">PRONTO âœ…</button></div>`;
        }
        pronto = true;
    });

    window.concluir = (id) => remove(ref(db, `pedidos/${id}`));
</script>
</body>
</html>
